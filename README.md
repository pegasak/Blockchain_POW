#  Криптографический проект: ГОСТ 34.11-2018, Шнорр, Меркл и Proof-of-Work

##  Описание

Этот проект реализует цепочку криптографических механизмов:
- Хэш-функция по ГОСТ 34.11-2018 (256 бит)
- Генератор псевдослучайных чисел (ГПСЧ)
- Подпись Шнорра в поле Z/p
- Хэш-дерево Меркла из транзакций
- Заголовок блока с подбором `nonce` по принципу Proof-of-Work

Проект выполнен в рамках практической работы в паре:  
 Алексей Жуков — реализовал ГОСТ, ГПСЧ и Шнорр  
 Кирилл Пегасов — реализовал транзакции, дерево Меркла и блок

---

##  Структура проекта
├── gost_hash.py # ГОСТ хэш + ГПСЧ

├── schnorr_signature.py # Подпись Шнорра, параметры p, q, a

├── merkle_tree.py # Построение дерева Меркла

├── main.py # Генерация и подпись транзакций 

├── step5_merkle.py # Вычисление корня Меркла 

├── block_header.py # Создание заголовка блока + подбор nonce 

├── transactions/ # Сырые транзакции tx*.bin

├── signed/ # Подписи tx*.sig


---

##  Реализованные компоненты

###  ГОСТ-хэш и PRNG (`gost_hash.py`)

- Реализация хэш-функции **ГОСТ Р 34.11-2018**, длина хэша: 256 бит.
- На основе хэша реализован **детерминированный генератор псевдослучайных чисел (PRNG)**.
- Используется во всех частях проекта (ключи, nonces, блоки).

---

###  Подпись Шнорра (`schnorr_signature.py`)

- Подпись `key-prefixed Schnorr` реализована в группе Z/p.
- Используются параметры из ГОСТ Р 34.10-94 (Пример A.3): `p`, `q`, `a`.
- Подпись имеет вид: `e, s`, где:
  - `s = k + x * e mod q`
  - `e = H(y || r || m) mod q`

---

###  Генерация и подписание транзакций (`main.py`)

- Генерируются 5 бинарных транзакций (по 200 байт).
- В одну из них вставляется **ФИО разработчика**.
- Каждая транзакция подписывается с уникальным `nonce` с помощью Шнорра.
- Подписи и данные сохраняются в папки `transactions/` и `signed/`.

---

###  Дерево Меркла (`merkle_tree.py`, `step5_merkle.py`)

- Каждая транзакция + подпись превращаются в **лист дерева**.
- Внутренние узлы строятся как `H(left || right)`.
- Если количество узлов нечётное — последний дублируется.
- Результат — **корень дерева Меркла (Merkle root)**.

---

###  Блок и PoW (`block_header.py`)

- Формируется заголовок блока:
  - Размер блока — 4 байта
  - Хэш предыдущего блока — 32 байта (из PRNG)
  - Merkle root — 32 байта
  - Timestamp — дата и время генерации
  - Nonce — 4 байта (подбирается)
- Выполняется **поиск nonce**, чтобы хэш заголовка начинался с **5 нулевых бит**.
- Результат: найденный nonce и хэш блока.

---

##  Инструкция по запуску

> Убедитесь, что у вас установлен **Python 3.9+**  
> Все модули используют **только стандартную библиотеку**.

###  Шаг 1: Подпись транзакций

```bash
python main.py
```
Результат:

    transactions/tx1.bin ... tx5.bin

    signed/tx1.sig ... tx5.sig

### Шаг 2: Расчёт Merkle root

```bash
python step5_merkle.py
```
Результат:

    Merkle root: <hex>

### Шаг 3: Создание заголовка блока и подбор nonce
```bash
python block_header.py
```
Результат:
    Найденный nonce

Итоговый хэш заголовка с 5 нулевыми битами